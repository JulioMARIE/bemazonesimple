{"ast":null,"code":"import _regeneratorRuntime from \"I:\\\\node_projects\\\\bmzn\\\\frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"I:\\\\node_projects\\\\bmzn\\\\frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"I:\\\\node_projects\\\\bmzn\\\\frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\nimport _objectSpread from \"I:\\\\node_projects\\\\bmzn\\\\frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread\";\nvar _jsxFileName = \"I:\\\\node_projects\\\\bmzn\\\\frontend\\\\src\\\\ProductScreen.js\";\nimport React, { useContext, useRef, useState } from 'react';\nimport { Link, useNavigate, useParams } from 'react-router-dom';\nimport { useEffect, useReducer } from 'react';\nimport axios from 'axios';\nimport Row from 'react-bootstrap/Row';\nimport Col from 'react-bootstrap/Col';\nimport Rating from './Rating';\nimport ListGroup from 'react-bootstrap/ListGroup';\nimport Badge from 'react-bootstrap/Badge';\nimport Card from 'react-bootstrap/Card';\nimport Button from 'react-bootstrap/Button';\nimport Form from 'react-bootstrap/Form';\nimport FloatingLabel from 'react-bootstrap/FloatingLabel';\nimport { Helmet } from 'react-helmet-async';\nimport LoadingBox from './LoadingBox';\nimport MessageBox from './MessageBox';\nimport { getError } from './utils';\nimport { Store } from './Store';\nimport { toast } from 'react-toastify';\n\nvar reducer = function reducer(state, action) {\n  switch (action.type) {\n    case 'REFRESH_PRODUCT':\n      return _objectSpread({}, state, {\n        product: action.payload\n      });\n\n    case 'CREATE_REQUEST':\n      return _objectSpread({}, state, {\n        loadingCreateReview: true\n      });\n\n    case 'CREATE_SUCCESS':\n      return _objectSpread({}, state, {\n        loadingCreateReview: false\n      });\n\n    case 'CREATE_FAIL':\n      return _objectSpread({}, state, {\n        loadingCreateReview: false\n      });\n\n    case 'FETCH_REQUEST':\n      return _objectSpread({}, state, {\n        loading: true\n      });\n\n    case 'FETCH_SUCCESS':\n      return _objectSpread({}, state, {\n        product: action.payload,\n        loading: false\n      });\n\n    case 'FETCH_FAIL':\n      return _objectSpread({}, state, {\n        loading: false,\n        error: action.payload\n      });\n\n    default:\n      return state;\n  }\n};\n\nfunction ProductScreen() {\n  var _this = this;\n\n  //var and funcs\n  var reviewsRef = useRef();\n\n  var _useState = useState(0),\n      _useState2 = _slicedToArray(_useState, 2),\n      rating = _useState2[0],\n      setRating = _useState2[1];\n\n  var _useState3 = useState(''),\n      _useState4 = _slicedToArray(_useState3, 2),\n      comment = _useState4[0],\n      setComment = _useState4[1];\n\n  var params = useParams();\n  var slug = params.slug;\n\n  var _useReducer = useReducer(reducer, {\n    product: [],\n    loading: true,\n    error: ''\n  }),\n      _useReducer2 = _slicedToArray(_useReducer, 2),\n      _useReducer2$ = _useReducer2[0],\n      loading = _useReducer2$.loading,\n      error = _useReducer2$.error,\n      product = _useReducer2$.product,\n      loadingCreateReview = _useReducer2$.loadingCreateReview,\n      dispatch = _useReducer2[1];\n\n  var navigate = useNavigate();\n  useEffect(function () {\n    var fetchData = /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var result;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                dispatch({\n                  type: 'FETCH_REQUEST'\n                });\n                _context.prev = 1;\n                _context.next = 4;\n                return axios.get(\"/api/products/slug/\".concat(slug));\n\n              case 4:\n                result = _context.sent;\n                dispatch({\n                  type: 'FETCH_SUCCESS',\n                  payload: result.data\n                });\n                _context.next = 11;\n                break;\n\n              case 8:\n                _context.prev = 8;\n                _context.t0 = _context[\"catch\"](1);\n                dispatch({\n                  type: 'FETCH_FAIL',\n                  payload: getError(_context.t0)\n                });\n\n              case 11:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[1, 8]]);\n      }));\n\n      return function fetchData() {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    fetchData();\n  }, [slug]);\n\n  var _useContext = useContext(Store),\n      state = _useContext.state,\n      ctxDispatch = _useContext.dispatch;\n\n  var cart = state.cart,\n      userInfo = state.userInfo;\n\n  var addToCartHandler = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var existItem, quantity, _yield$axios$get, data;\n\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              existItem = cart.cartItems.find(function (x) {\n                return x._id === product._id;\n              });\n              quantity = existItem ? existItem.quantity + 1 : 1;\n              _context2.next = 4;\n              return axios.get(\"/api/products/\".concat(product._id));\n\n            case 4:\n              _yield$axios$get = _context2.sent;\n              data = _yield$axios$get.data;\n\n              if (!(data.countInStock < quantity)) {\n                _context2.next = 9;\n                break;\n              }\n\n              window.alert('Sorry. Product is out of stock');\n              return _context2.abrupt(\"return\");\n\n            case 9:\n              ctxDispatch({\n                type: 'CART_ADD_ITEM',\n                payload: _objectSpread({}, product, {\n                  quantity: quantity\n                })\n              });\n              navigate('/cart');\n\n            case 11:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function addToCartHandler() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var submitHandler = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(e) {\n      var _yield$axios$post, data;\n\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              e.preventDefault();\n\n              if (!(!comment || !rating)) {\n                _context3.next = 4;\n                break;\n              }\n\n              toast.error('Please enter comment and rating');\n              return _context3.abrupt(\"return\");\n\n            case 4:\n              _context3.prev = 4;\n              _context3.next = 7;\n              return axios.post(\"/api/products/\".concat(product._id, \"/reviews\"), {\n                rating: rating,\n                comment: comment,\n                name: userInfo.name\n              }, {\n                headers: {\n                  Authorization: \"Bearer \".concat(userInfo.token)\n                }\n              });\n\n            case 7:\n              _yield$axios$post = _context3.sent;\n              data = _yield$axios$post.data;\n              dispatch({\n                type: 'CREATE_SUCCESS'\n              });\n              toast.success('Review submitted successfully');\n              product.reviews.unshift(data.review);\n              product.numReviews = data.numReviews;\n              product.rating = data.rating;\n              dispatch({\n                type: 'REFRESH_PRODUCT',\n                payload: product\n              });\n              window.scrollTo({\n                behavior: 'smooth',\n                top: reviewsRef.current.offsetTop\n              });\n              _context3.next = 22;\n              break;\n\n            case 18:\n              _context3.prev = 18;\n              _context3.t0 = _context3[\"catch\"](4);\n              toast.error(getError(_context3.t0));\n              dispatch({\n                type: 'CREATE_FAIL'\n              });\n\n            case 22:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3, null, [[4, 18]]);\n    }));\n\n    return function submitHandler(_x) {\n      return _ref3.apply(this, arguments);\n    };\n  }(); //end var and funcs\n\n\n  return loading ? /*#__PURE__*/React.createElement(LoadingBox, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 5\n    }\n  }) : error ? /*#__PURE__*/React.createElement(MessageBox, {\n    variant: \"danger\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 5\n    }\n  }, error) : /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Col, {\n    md: 6,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: product.image,\n    alt: product.name,\n    className: \"img-large\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(Col, {\n    md: 3,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(ListGroup, {\n    variant: \"flush\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(ListGroup.Item, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Helmet, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"title\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 17\n    }\n  }, product.name)), /*#__PURE__*/React.createElement(\"h1\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 15\n    }\n  }, product.name)), /*#__PURE__*/React.createElement(ListGroup.Item, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Rating, {\n    rating: product.rating,\n    numReviews: product.numReviews,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 15\n    }\n  })), /*#__PURE__*/React.createElement(ListGroup.Item, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 13\n    }\n  }, \"Price : $\", product.price), /*#__PURE__*/React.createElement(ListGroup.Item, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 13\n    }\n  }, \"Description:\", /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 15\n    }\n  }, product.description)))), /*#__PURE__*/React.createElement(Col, {\n    md: 3,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Card, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Card.Body, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(ListGroup, {\n    variant: \"flush\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(ListGroup.Item, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 21\n    }\n  }, \"Price:\"), /*#__PURE__*/React.createElement(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 21\n    }\n  }, \"$\", product.price))), /*#__PURE__*/React.createElement(ListGroup.Item, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 21\n    }\n  }, \"Status:\"), /*#__PURE__*/React.createElement(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 21\n    }\n  }, product.countInStock > 0 ? /*#__PURE__*/React.createElement(Badge, {\n    bg: \"success\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 25\n    }\n  }, \"In Stock\") : /*#__PURE__*/React.createElement(Badge, {\n    bg: \"danger\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 25\n    }\n  }, \"Unavailable\")))), product.countInStock > 0 && /*#__PURE__*/React.createElement(ListGroup.Item, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"d-grid\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    onClick: addToCartHandler,\n    variant: \"primary\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 183,\n      columnNumber: 23\n    }\n  }, \"Add to cart\")))))))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"my-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    ref: reviewsRef,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 195,\n      columnNumber: 9\n    }\n  }, \"Reviews\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"mb-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 9\n    }\n  }, product.reviews.length === 0 && /*#__PURE__*/React.createElement(MessageBox, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 198,\n      columnNumber: 13\n    }\n  }, \"There is no review\")), /*#__PURE__*/React.createElement(ListGroup, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 201,\n      columnNumber: 9\n    }\n  }, product.reviews.map(function (review) {\n    return /*#__PURE__*/React.createElement(ListGroup.Item, {\n      key: review.id,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 203,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"strong\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 204,\n        columnNumber: 15\n      }\n    }, review.name), /*#__PURE__*/React.createElement(Rating, {\n      rating: review.rating,\n      caption: \" \",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 205,\n        columnNumber: 15\n      }\n    }), /*#__PURE__*/React.createElement(\"p\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 206,\n        columnNumber: 15\n      }\n    }, review.createdAt.substring(0, 10)), /*#__PURE__*/React.createElement(\"p\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 207,\n        columnNumber: 15\n      }\n    }, review.comment));\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"my-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 211,\n      columnNumber: 9\n    }\n  }, userInfo ? /*#__PURE__*/React.createElement(\"form\", {\n    onSubmit: submitHandler,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 213,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 214,\n      columnNumber: 15\n    }\n  }, \"Write a customer review\"), /*#__PURE__*/React.createElement(Form.Group, {\n    className: \"mb-3\",\n    controlId: \"rating\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 215,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(Form.Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 216,\n      columnNumber: 17\n    }\n  }, \"Rating\"), /*#__PURE__*/React.createElement(Form.Select, {\n    \"aria-label\": \"Rating\",\n    value: rating,\n    onChange: function onChange(e) {\n      return setRating(e.target.value);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 217,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"option\", {\n    value: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 222,\n      columnNumber: 19\n    }\n  }, \"Select...\"), /*#__PURE__*/React.createElement(\"option\", {\n    value: \"1\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 223,\n      columnNumber: 19\n    }\n  }, \"1- Poor\"), /*#__PURE__*/React.createElement(\"option\", {\n    value: \"2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 224,\n      columnNumber: 19\n    }\n  }, \"2- Fair\"), /*#__PURE__*/React.createElement(\"option\", {\n    value: \"3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 225,\n      columnNumber: 19\n    }\n  }, \"3- Good\"), /*#__PURE__*/React.createElement(\"option\", {\n    value: \"4\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 226,\n      columnNumber: 19\n    }\n  }, \"4- Very Good\"), /*#__PURE__*/React.createElement(\"option\", {\n    value: \"5\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 227,\n      columnNumber: 19\n    }\n  }, \"5- Excellent\"))), /*#__PURE__*/React.createElement(FloatingLabel, {\n    controlId: \"floatingTextarea\",\n    label: \"Comments\",\n    className: \"mb-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 230,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(Form.Control, {\n    as: \"textarea\",\n    placeholder: \"Leave a comment here\",\n    value: comment,\n    onChange: function onChange(e) {\n      return setComment(e.target.value);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 235,\n      columnNumber: 17\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"mb-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 242,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    disabled: loadingCreateReview,\n    type: \"submit\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 243,\n      columnNumber: 17\n    }\n  }, \"Submit\"), loadingCreateReview && /*#__PURE__*/React.createElement(LoadingBox, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 246,\n      columnNumber: 41\n    }\n  }))) : /*#__PURE__*/React.createElement(MessageBox, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 250,\n      columnNumber: 13\n    }\n  }, \"Please\", ' ', /*#__PURE__*/React.createElement(Link, {\n    to: \"/signin?redirect=/product/\".concat(product.slug),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 252,\n      columnNumber: 15\n    }\n  }, \"Sign In\"), ' ', \"to write a review\"))));\n}\n\nexport default ProductScreen;","map":{"version":3,"sources":["I:/node_projects/bmzn/frontend/src/ProductScreen.js"],"names":["React","useContext","useRef","useState","Link","useNavigate","useParams","useEffect","useReducer","axios","Row","Col","Rating","ListGroup","Badge","Card","Button","Form","FloatingLabel","Helmet","LoadingBox","MessageBox","getError","Store","toast","reducer","state","action","type","product","payload","loadingCreateReview","loading","error","ProductScreen","reviewsRef","rating","setRating","comment","setComment","params","slug","dispatch","navigate","fetchData","get","result","data","ctxDispatch","cart","userInfo","addToCartHandler","existItem","cartItems","find","x","_id","quantity","countInStock","window","alert","submitHandler","e","preventDefault","post","name","headers","Authorization","token","success","reviews","unshift","review","numReviews","scrollTo","behavior","top","current","offsetTop","image","price","description","length","map","id","createdAt","substring","target","value"],"mappings":"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","sourcesContent":["import React, { useContext, useRef, useState } from 'react';\r\nimport { Link, useNavigate, useParams } from 'react-router-dom';\r\nimport { useEffect, useReducer } from 'react';\r\nimport axios from 'axios';\r\nimport Row from 'react-bootstrap/Row';\r\nimport Col from 'react-bootstrap/Col';\r\nimport Rating from './Rating';\r\nimport ListGroup from 'react-bootstrap/ListGroup';\r\nimport Badge from 'react-bootstrap/Badge';\r\nimport Card from 'react-bootstrap/Card';\r\nimport Button from 'react-bootstrap/Button';\r\nimport Form from 'react-bootstrap/Form';\r\nimport FloatingLabel from 'react-bootstrap/FloatingLabel';\r\nimport { Helmet } from 'react-helmet-async';\r\nimport LoadingBox from './LoadingBox';\r\nimport MessageBox from './MessageBox';\r\nimport { getError } from './utils';\r\nimport { Store } from './Store';\r\nimport { toast } from 'react-toastify';\r\n\r\nconst reducer = (state, action) => {\r\n  switch (action.type) {\r\n    case 'REFRESH_PRODUCT':\r\n      return { ...state, product: action.payload };\r\n    case 'CREATE_REQUEST':\r\n      return { ...state, loadingCreateReview: true };\r\n    case 'CREATE_SUCCESS':\r\n      return { ...state, loadingCreateReview: false };\r\n    case 'CREATE_FAIL':\r\n      return { ...state, loadingCreateReview: false };\r\n    case 'FETCH_REQUEST':\r\n      return { ...state, loading: true };\r\n    case 'FETCH_SUCCESS':\r\n      return { ...state, product: action.payload, loading: false };\r\n    case 'FETCH_FAIL':\r\n      return { ...state, loading: false, error: action.payload };\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nfunction ProductScreen() {\r\n  //var and funcs\r\n  const reviewsRef = useRef();\r\n\r\n  const [rating, setRating] = useState(0);\r\n  const [comment, setComment] = useState('');\r\n\r\n  const params = useParams();\r\n  const { slug } = params;\r\n\r\n  const [\r\n    { loading, error, product, loadingCreateReview },\r\n    dispatch,\r\n  ] = useReducer(reducer, {\r\n    product: [],\r\n    loading: true,\r\n    error: '',\r\n  });\r\n\r\n  const navigate = useNavigate();\r\n\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      dispatch({ type: 'FETCH_REQUEST' });\r\n      try {\r\n        const result = await axios.get(`/api/products/slug/${slug}`);\r\n        dispatch({ type: 'FETCH_SUCCESS', payload: result.data });\r\n      } catch (error) {\r\n        dispatch({ type: 'FETCH_FAIL', payload: getError(error) });\r\n      }\r\n    };\r\n    fetchData();\r\n  }, [slug]);\r\n\r\n  const { state, dispatch: ctxDispatch } = useContext(Store);\r\n  const { cart, userInfo } = state;\r\n  const addToCartHandler = async () => {\r\n    const existItem = cart.cartItems.find((x) => x._id === product._id);\r\n    const quantity = existItem ? existItem.quantity + 1 : 1;\r\n    const { data } = await axios.get(`/api/products/${product._id}`);\r\n    if (data.countInStock < quantity) {\r\n      window.alert('Sorry. Product is out of stock');\r\n      return;\r\n    }\r\n    ctxDispatch({\r\n      type: 'CART_ADD_ITEM',\r\n      payload: { ...product, quantity },\r\n    });\r\n    navigate('/cart');\r\n  };\r\n\r\n  const submitHandler = async (e) => {\r\n    e.preventDefault();\r\n    if (!comment || !rating) {\r\n      toast.error('Please enter comment and rating');\r\n      return;\r\n    }\r\n    try {\r\n      const { data } = await axios.post(\r\n        `/api/products/${product._id}/reviews`,\r\n        { rating, comment, name: userInfo.name },\r\n        {\r\n          headers: { Authorization: `Bearer ${userInfo.token}` },\r\n        }\r\n      );\r\n      dispatch({\r\n        type: 'CREATE_SUCCESS',\r\n      });\r\n      toast.success('Review submitted successfully');\r\n      product.reviews.unshift(data.review);\r\n      product.numReviews = data.numReviews;\r\n      product.rating = data.rating;\r\n      dispatch({ type: 'REFRESH_PRODUCT', payload: product });\r\n      window.scrollTo({\r\n        behavior: 'smooth',\r\n        top: reviewsRef.current.offsetTop,\r\n      });\r\n    } catch (error) {\r\n      toast.error(getError(error));\r\n      dispatch({ type: 'CREATE_FAIL' });\r\n    }\r\n  };\r\n  //end var and funcs\r\n\r\n  return loading ? (\r\n    <LoadingBox />\r\n  ) : error ? (\r\n    <MessageBox variant=\"danger\">{error}</MessageBox>\r\n  ) : (\r\n    <div>\r\n      <Row>\r\n        <Col md={6}>\r\n          <img src={product.image} alt={product.name} className=\"img-large\" />\r\n        </Col>\r\n        <Col md={3}>\r\n          <ListGroup variant=\"flush\">\r\n            <ListGroup.Item>\r\n              <Helmet>\r\n                <title>{product.name}</title>\r\n              </Helmet>\r\n              <h1>{product.name}</h1>\r\n            </ListGroup.Item>\r\n            <ListGroup.Item>\r\n              <Rating\r\n                rating={product.rating}\r\n                numReviews={product.numReviews}\r\n              ></Rating>\r\n            </ListGroup.Item>\r\n            <ListGroup.Item>Price : ${product.price}</ListGroup.Item>\r\n            <ListGroup.Item>\r\n              Description:\r\n              <p>{product.description}</p>\r\n            </ListGroup.Item>\r\n          </ListGroup>\r\n        </Col>\r\n        <Col md={3}>\r\n          <Card>\r\n            <Card.Body>\r\n              <ListGroup variant=\"flush\">\r\n                <ListGroup.Item>\r\n                  <Row>\r\n                    <Col>Price:</Col>\r\n                    <Col>${product.price}</Col>\r\n                  </Row>\r\n                </ListGroup.Item>\r\n                <ListGroup.Item>\r\n                  <Row>\r\n                    <Col>Status:</Col>\r\n                    <Col>\r\n                      {product.countInStock > 0 ? (\r\n                        <Badge bg=\"success\">In Stock</Badge>\r\n                      ) : (\r\n                        <Badge bg=\"danger\">Unavailable</Badge>\r\n                      )}\r\n                    </Col>\r\n                  </Row>\r\n                </ListGroup.Item>\r\n\r\n                {product.countInStock > 0 && (\r\n                  <ListGroup.Item>\r\n                    <div className=\"d-grid\">\r\n                      <Button onClick={addToCartHandler} variant=\"primary\">\r\n                        Add to cart\r\n                      </Button>\r\n                    </div>\r\n                  </ListGroup.Item>\r\n                )}\r\n              </ListGroup>\r\n            </Card.Body>\r\n          </Card>\r\n        </Col>\r\n      </Row>\r\n      <div className=\"my-3\">\r\n        <h2 ref={reviewsRef}>Reviews</h2>\r\n        <div className=\"mb-3\">\r\n          {product.reviews.length === 0 && (\r\n            <MessageBox>There is no review</MessageBox>\r\n          )}\r\n        </div>\r\n        <ListGroup>\r\n          {product.reviews.map((review) => (\r\n            <ListGroup.Item key={review.id}>\r\n              <strong>{review.name}</strong>\r\n              <Rating rating={review.rating} caption=\" \"></Rating>\r\n              <p>{review.createdAt.substring(0, 10)}</p>\r\n              <p>{review.comment}</p>\r\n            </ListGroup.Item>\r\n          ))}\r\n        </ListGroup>\r\n        <div className=\"my-3\">\r\n          {userInfo ? (\r\n            <form onSubmit={submitHandler}>\r\n              <h2>Write a customer review</h2>\r\n              <Form.Group className=\"mb-3\" controlId=\"rating\">\r\n                <Form.Label>Rating</Form.Label>\r\n                <Form.Select\r\n                  aria-label=\"Rating\"\r\n                  value={rating}\r\n                  onChange={(e) => setRating(e.target.value)}\r\n                >\r\n                  <option value=\"\">Select...</option>\r\n                  <option value=\"1\">1- Poor</option>\r\n                  <option value=\"2\">2- Fair</option>\r\n                  <option value=\"3\">3- Good</option>\r\n                  <option value=\"4\">4- Very Good</option>\r\n                  <option value=\"5\">5- Excellent</option>\r\n                </Form.Select>\r\n              </Form.Group>\r\n              <FloatingLabel\r\n                controlId=\"floatingTextarea\"\r\n                label=\"Comments\"\r\n                className=\"mb-3\"\r\n              >\r\n                <Form.Control\r\n                  as=\"textarea\"\r\n                  placeholder=\"Leave a comment here\"\r\n                  value={comment}\r\n                  onChange={(e) => setComment(e.target.value)}\r\n                />\r\n              </FloatingLabel>\r\n              <div className=\"mb-3\">\r\n                <Button disabled={loadingCreateReview} type=\"submit\">\r\n                  Submit\r\n                </Button>\r\n                {loadingCreateReview && <LoadingBox></LoadingBox>}\r\n              </div>\r\n            </form>\r\n          ) : (\r\n            <MessageBox>\r\n              Please{' '}\r\n              <Link to={`/signin?redirect=/product/${product.slug}`}>\r\n                Sign In\r\n              </Link>{' '}\r\n              to write a review\r\n            </MessageBox>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ProductScreen;\r\n"]},"metadata":{},"sourceType":"module"}