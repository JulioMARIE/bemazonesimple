{"ast":null,"code":"import _regeneratorRuntime from \"I:\\\\node_projects\\\\bmzn\\\\frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"I:\\\\node_projects\\\\bmzn\\\\frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"I:\\\\node_projects\\\\bmzn\\\\frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\nimport _objectSpread from \"I:\\\\node_projects\\\\bmzn\\\\frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread\";\nvar _jsxFileName = \"I:\\\\node_projects\\\\bmzn\\\\frontend\\\\src\\\\OrderScreen.js\";\nimport axios from 'axios';\nimport React, { useContext, useEffect, useReducer } from 'react';\nimport { PayPalButtons, usePayPalScriptReducer } from '@paypal/react-paypal-js';\nimport { Helmet } from 'react-helmet-async';\nimport { Link, useNavigate, useParams } from 'react-router-dom';\nimport LoadingBox from './LoadingBox';\nimport MessageBox from './MessageBox';\nimport { Store } from './Store';\nimport { getError } from './utils';\nimport Col from 'react-bootstrap/Col';\nimport Row from 'react-bootstrap/Row';\nimport Card from 'react-bootstrap/Card';\nimport ListGroup from 'react-bootstrap/ListGroup';\nimport { toast } from 'react-toastify';\n\nfunction reducer(state, action) {\n  switch (action.type) {\n    case 'FETCH_REQUEST':\n      return _objectSpread({}, state, {\n        loading: true,\n        error: ''\n      });\n\n    case 'FETCH_SUCCESS':\n      return _objectSpread({}, state, {\n        loading: false,\n        order: action.payload,\n        error: ''\n      });\n\n    case 'FETCH_FAIL':\n      return _objectSpread({}, state, {\n        loading: false,\n        error: action.payload\n      });\n\n    case 'PAY_REQUEST':\n      return _objectSpread({}, state, {\n        loadingPay: true\n      });\n\n    case 'PAY_SUCCESS':\n      return _objectSpread({}, state, {\n        loadingPay: false,\n        successPay: true\n      });\n\n    case 'PAY_FAIL':\n      return _objectSpread({}, state, {\n        loadingPay: false\n      });\n\n    case 'PAY_RESET':\n      return _objectSpread({}, state, {\n        loadingPay: false,\n        successPay: false\n      });\n\n    default:\n      return state;\n  }\n}\n\nfunction OrderScreen() {\n  var _this = this;\n\n  var _useContext = useContext(Store),\n      state = _useContext.state;\n\n  var userInfo = state.userInfo;\n  var params = useParams();\n  var orderId = params.id;\n  var navigate = useNavigate();\n\n  var _useReducer = useReducer(reducer, {\n    loading: true,\n    order: {},\n    error: '',\n    successPay: false,\n    loadingPay: false\n  }),\n      _useReducer2 = _slicedToArray(_useReducer, 2),\n      _useReducer2$ = _useReducer2[0],\n      loading = _useReducer2$.loading,\n      error = _useReducer2$.error,\n      order = _useReducer2$.order,\n      successPay = _useReducer2$.successPay,\n      loadingPay = _useReducer2$.loadingPay,\n      dispatch = _useReducer2[1];\n\n  var _usePayPalScriptReduc = usePayPalScriptReducer(),\n      _usePayPalScriptReduc2 = _slicedToArray(_usePayPalScriptReduc, 2),\n      isPending = _usePayPalScriptReduc2[0].isPending,\n      paypalDispatch = _usePayPalScriptReduc2[1];\n\n  function createOrder(data, actions) {\n    return actions.order.create({\n      purchase_units: [{\n        amount: {\n          value: order.totalPrice\n        }\n      }]\n    }).then(function (orderID) {\n      return orderID;\n    });\n  }\n\n  function onApprove(data, actions) {\n    return actions.order.capture().then( /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(details) {\n        var _yield$axios$put, _data;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                dispatch({\n                  type: 'PAY_REQUEST'\n                });\n                _context.next = 4;\n                return axios.put(\"/api/orders/\".concat(order._id, \"/pay\"), details, {\n                  headers: {\n                    authorization: \"Bearer \".concat(userInfo.token)\n                  }\n                });\n\n              case 4:\n                _yield$axios$put = _context.sent;\n                _data = _yield$axios$put.data;\n                dispatch({\n                  type: 'PAY_SUCCESS',\n                  payload: _data\n                });\n                toast.success('Order is paid');\n                _context.next = 14;\n                break;\n\n              case 10:\n                _context.prev = 10;\n                _context.t0 = _context[\"catch\"](0);\n                dispatch({\n                  type: 'PAY_FAIL',\n                  payload: getError(_context.t0)\n                });\n                toast.error(getError(_context.t0));\n\n              case 14:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[0, 10]]);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }());\n  }\n\n  function onError(err) {\n    toast.error(getError(err));\n  }\n\n  useEffect(function () {\n    var fetchOrder = /*#__PURE__*/function () {\n      var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n        var _yield$axios$get, data;\n\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.prev = 0;\n                dispatch({\n                  type: 'FETCH_REQUEST'\n                });\n                _context2.next = 4;\n                return axios.get(\"/api/orders/\".concat(orderId), {\n                  headers: {\n                    authorization: \"Bearer \".concat(userInfo.token)\n                  }\n                });\n\n              case 4:\n                _yield$axios$get = _context2.sent;\n                data = _yield$axios$get.data;\n                dispatch({\n                  type: 'FETCH_SUCCESS',\n                  payload: data\n                });\n                _context2.next = 12;\n                break;\n\n              case 9:\n                _context2.prev = 9;\n                _context2.t0 = _context2[\"catch\"](0);\n                dispatch({\n                  type: 'FETCH_FAIL',\n                  payload: getError(_context2.t0)\n                });\n\n              case 12:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, null, [[0, 9]]);\n      }));\n\n      return function fetchOrder() {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n\n    if (!userInfo) {\n      return navigate('/signin');\n    }\n\n    if (!order._id || successPay || order._id && order._id !== orderId) {\n      fetchOrder();\n\n      if (successPay) {\n        dispatch({\n          type: 'PAY_RESET'\n        });\n      }\n    } else {\n      var loadPayPalScript = /*#__PURE__*/function () {\n        var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n          var _yield$axios$get2, clientId;\n\n          return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n            while (1) {\n              switch (_context3.prev = _context3.next) {\n                case 0:\n                  _context3.next = 2;\n                  return axios.get('/api/keys/paypal', {\n                    headers: {\n                      authorization: \"Bearer \".concat(userInfo.token)\n                    }\n                  });\n\n                case 2:\n                  _yield$axios$get2 = _context3.sent;\n                  clientId = _yield$axios$get2.data;\n                  paypalDispatch({\n                    type: 'resetOptions',\n                    value: {\n                      'client-id': clientId,\n                      currency: 'USD'\n                    }\n                  });\n                  paypalDispatch({\n                    type: 'setLoadingStatus',\n                    value: 'pending'\n                  });\n\n                case 6:\n                case \"end\":\n                  return _context3.stop();\n              }\n            }\n          }, _callee3);\n        }));\n\n        return function loadPayPalScript() {\n          return _ref3.apply(this, arguments);\n        };\n      }();\n\n      loadPayPalScript();\n    }\n  }, [order, userInfo, orderId, navigate, paypalDispatch, successPay]);\n  return loading ? /*#__PURE__*/React.createElement(LoadingBox, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 5\n    }\n  }) : error ? /*#__PURE__*/React.createElement(MessageBox, {\n    variant: \"danger\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 5\n    }\n  }, error) : /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Helmet, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"title\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 9\n    }\n  }, \"Order \", orderId)), /*#__PURE__*/React.createElement(\"h1\", {\n    className: \"my-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 7\n    }\n  }, \"Order \", orderId), /*#__PURE__*/React.createElement(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Col, {\n    md: 8,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Card, {\n    className: \"mb-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Card.Body, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Card.Title, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 15\n    }\n  }, \"Shipping\"), /*#__PURE__*/React.createElement(Card.Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 17\n    }\n  }, \"Name:\"), \" \", order.shippingAddress.fullName, /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 17\n    }\n  }), /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 17\n    }\n  }, \"Address:\"), \" \", order.shippingAddress.address, \",\", ' ', order.shippingAddress.city, \", \", order.shippingAddress.postalCode, \", \", order.shippingAddress.country), order.isDelivered ? /*#__PURE__*/React.createElement(MessageBox, {\n    variant: \"success\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 17\n    }\n  }, \"Delivered at \", order.deliveredAt) : /*#__PURE__*/React.createElement(MessageBox, {\n    variant: \"danger\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 17\n    }\n  }, \"Not Delivered\"))), /*#__PURE__*/React.createElement(Card, {\n    className: \"mb-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Card.Body, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Card.Title, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 15\n    }\n  }, \"Payment\"), /*#__PURE__*/React.createElement(Card.Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 17\n    }\n  }, \"Method:\"), \" \", order.paymentMethod), order.isPaid ? /*#__PURE__*/React.createElement(MessageBox, {\n    variant: \"success\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 173,\n      columnNumber: 17\n    }\n  }, \"Paid at \", order.paidAt) : /*#__PURE__*/React.createElement(MessageBox, {\n    variant: \"danger\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 17\n    }\n  }, \"Not Paid\"))), /*#__PURE__*/React.createElement(Card, {\n    className: \"mb-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Card.Body, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Card.Title, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 183,\n      columnNumber: 15\n    }\n  }, \"Items\"), /*#__PURE__*/React.createElement(ListGroup, {\n    variant: \"flush\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184,\n      columnNumber: 15\n    }\n  }, order.orderItems.map(function (item) {\n    return /*#__PURE__*/React.createElement(ListGroup.Item, {\n      key: item._id,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 186,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(Row, {\n      className: \"align-items-center\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 187,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(Col, {\n      md: 6,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 188,\n        columnNumber: 23\n      }\n    }, /*#__PURE__*/React.createElement(\"img\", {\n      src: item.image,\n      alt: item.name,\n      className: \"img-fluid rounded img-thumbnail\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 189,\n        columnNumber: 25\n      }\n    }), ' ', /*#__PURE__*/React.createElement(Link, {\n      to: \"/product/\".concat(item.slug),\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 194,\n        columnNumber: 25\n      }\n    }, item.name)), /*#__PURE__*/React.createElement(Col, {\n      md: 3,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 196,\n        columnNumber: 23\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 197,\n        columnNumber: 25\n      }\n    }, item.quantity)), /*#__PURE__*/React.createElement(Col, {\n      md: 3,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 199,\n        columnNumber: 23\n      }\n    }, \"$\", item.price)));\n  }))))), /*#__PURE__*/React.createElement(Col, {\n    md: 4,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 207,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Card, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 208,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Card.Body, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 209,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Card.Title, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 210,\n      columnNumber: 15\n    }\n  }, \"Order Summary\"), /*#__PURE__*/React.createElement(ListGroup, {\n    variant: \"flush\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 211,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(ListGroup.Item, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 212,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 213,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 214,\n      columnNumber: 21\n    }\n  }, \"Items\"), /*#__PURE__*/React.createElement(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 215,\n      columnNumber: 21\n    }\n  }, \"$\", order.itemsPrice.toFixed(2)))), /*#__PURE__*/React.createElement(ListGroup.Item, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 218,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 219,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 220,\n      columnNumber: 21\n    }\n  }, \"Shipping\"), /*#__PURE__*/React.createElement(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 221,\n      columnNumber: 21\n    }\n  }, \"$\", order.shippingPrice.toFixed(2)))), /*#__PURE__*/React.createElement(ListGroup.Item, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 224,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 225,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 226,\n      columnNumber: 21\n    }\n  }, \"Tax\"), /*#__PURE__*/React.createElement(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 227,\n      columnNumber: 21\n    }\n  }, \"$\", order.taxPrice.toFixed(2)))), /*#__PURE__*/React.createElement(ListGroup.Item, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 230,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 231,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 232,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 233,\n      columnNumber: 23\n    }\n  }, \"Order Total\")), /*#__PURE__*/React.createElement(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 235,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 236,\n      columnNumber: 23\n    }\n  }, \"$\", order.totalPrice.toFixed(2))))), !order.isPaid && /*#__PURE__*/React.createElement(ListGroup.Item, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 241,\n      columnNumber: 19\n    }\n  }, isPending ? /*#__PURE__*/React.createElement(LoadingBox, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 243,\n      columnNumber: 23\n    }\n  }) : /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 245,\n      columnNumber: 23\n    }\n  }, /*#__PURE__*/React.createElement(PayPalButtons, {\n    createOrder: createOrder,\n    onApprove: onApprove,\n    onError: onError,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 246,\n      columnNumber: 25\n    }\n  })))))))));\n}\n\nexport default OrderScreen;","map":{"version":3,"sources":["I:/node_projects/bmzn/frontend/src/OrderScreen.js"],"names":["axios","React","useContext","useEffect","useReducer","PayPalButtons","usePayPalScriptReducer","Helmet","Link","useNavigate","useParams","LoadingBox","MessageBox","Store","getError","Col","Row","Card","ListGroup","toast","reducer","state","action","type","loading","error","order","payload","loadingPay","successPay","OrderScreen","userInfo","params","orderId","id","navigate","dispatch","isPending","paypalDispatch","createOrder","data","actions","create","purchase_units","amount","value","totalPrice","then","orderID","onApprove","capture","details","put","_id","headers","authorization","token","success","onError","err","fetchOrder","get","loadPayPalScript","clientId","currency","shippingAddress","fullName","address","city","postalCode","country","isDelivered","deliveredAt","paymentMethod","isPaid","paidAt","orderItems","map","item","image","name","slug","quantity","price","itemsPrice","toFixed","shippingPrice","taxPrice"],"mappings":"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","sourcesContent":["import axios from 'axios';\r\nimport React, { useContext, useEffect, useReducer } from 'react';\r\nimport { PayPalButtons, usePayPalScriptReducer } from '@paypal/react-paypal-js';\r\nimport { Helmet } from 'react-helmet-async';\r\nimport { Link, useNavigate, useParams } from 'react-router-dom';\r\nimport LoadingBox from './LoadingBox';\r\nimport MessageBox from './MessageBox';\r\nimport { Store } from './Store';\r\nimport { getError } from './utils';\r\nimport Col from 'react-bootstrap/Col';\r\nimport Row from 'react-bootstrap/Row';\r\nimport Card from 'react-bootstrap/Card';\r\nimport ListGroup from 'react-bootstrap/ListGroup';\r\nimport { toast } from 'react-toastify';\r\n\r\nfunction reducer(state, action) {\r\n  switch (action.type) {\r\n    case 'FETCH_REQUEST':\r\n      return { ...state, loading: true, error: '' };\r\n    case 'FETCH_SUCCESS':\r\n      return { ...state, loading: false, order: action.payload, error: '' };\r\n    case 'FETCH_FAIL':\r\n      return { ...state, loading: false, error: action.payload };\r\n    case 'PAY_REQUEST':\r\n      return { ...state, loadingPay: true };\r\n    case 'PAY_SUCCESS':\r\n      return { ...state, loadingPay: false, successPay: true };\r\n    case 'PAY_FAIL':\r\n      return { ...state, loadingPay: false };\r\n    case 'PAY_RESET':\r\n      return { ...state, loadingPay: false, successPay: false };\r\n\r\n    default:\r\n      return state;\r\n  }\r\n}\r\n\r\nfunction OrderScreen() {\r\n  const { state } = useContext(Store);\r\n  const { userInfo } = state;\r\n\r\n  const params = useParams();\r\n  const { id: orderId } = params;\r\n  const navigate = useNavigate();\r\n\r\n  const [\r\n    { loading, error, order, successPay, loadingPay },\r\n    dispatch,\r\n  ] = useReducer(reducer, {\r\n    loading: true,\r\n    order: {},\r\n    error: '',\r\n    successPay: false,\r\n    loadingPay: false,\r\n  });\r\n\r\n  const [{ isPending }, paypalDispatch] = usePayPalScriptReducer();\r\n\r\n  function createOrder(data, actions) {\r\n    return actions.order\r\n      .create({\r\n        purchase_units: [\r\n          {\r\n            amount: { value: order.totalPrice },\r\n          },\r\n        ],\r\n      })\r\n      .then((orderID) => {\r\n        return orderID;\r\n      });\r\n  }\r\n\r\n  function onApprove(data, actions) {\r\n    return actions.order.capture().then(async function(details) {\r\n      try {\r\n        dispatch({ type: 'PAY_REQUEST' });\r\n        const { data } = await axios.put(\r\n          `/api/orders/${order._id}/pay`,\r\n          details,\r\n          {\r\n            headers: { authorization: `Bearer ${userInfo.token}` },\r\n          }\r\n        );\r\n        dispatch({ type: 'PAY_SUCCESS', payload: data });\r\n        toast.success('Order is paid');\r\n      } catch (err) {\r\n        dispatch({ type: 'PAY_FAIL', payload: getError(err) });\r\n        toast.error(getError(err));\r\n      }\r\n    });\r\n  }\r\n\r\n  function onError(err) {\r\n    toast.error(getError(err));\r\n  }\r\n\r\n  useEffect(() => {\r\n    const fetchOrder = async () => {\r\n      try {\r\n        dispatch({ type: 'FETCH_REQUEST' });\r\n        const { data } = await axios.get(`/api/orders/${orderId}`, {\r\n          headers: { authorization: `Bearer ${userInfo.token}` },\r\n        });\r\n        dispatch({ type: 'FETCH_SUCCESS', payload: data });\r\n      } catch (err) {\r\n        dispatch({ type: 'FETCH_FAIL', payload: getError(err) });\r\n      }\r\n    };\r\n    if (!userInfo) {\r\n      return navigate('/signin');\r\n    }\r\n    if (!order._id || successPay || (order._id && order._id !== orderId)) {\r\n      fetchOrder();\r\n      if (successPay) {\r\n        dispatch({ type: 'PAY_RESET' });\r\n      }\r\n    } else {\r\n      const loadPayPalScript = async () => {\r\n        const { data: clientId } = await axios.get('/api/keys/paypal', {\r\n          headers: { authorization: `Bearer ${userInfo.token}` },\r\n        });\r\n        paypalDispatch({\r\n          type: 'resetOptions',\r\n          value: {\r\n            'client-id': clientId,\r\n            currency: 'USD',\r\n          },\r\n        });\r\n        paypalDispatch({ type: 'setLoadingStatus', value: 'pending' });\r\n      };\r\n      loadPayPalScript();\r\n    }\r\n  }, [order, userInfo, orderId, navigate, paypalDispatch, successPay]);\r\n\r\n  return loading ? (\r\n    <LoadingBox></LoadingBox>\r\n  ) : error ? (\r\n    <MessageBox variant=\"danger\">{error}</MessageBox>\r\n  ) : (\r\n    <div>\r\n      <Helmet>\r\n        <title>Order {orderId}</title>\r\n      </Helmet>\r\n      <h1 className=\"my-3\">Order {orderId}</h1>\r\n      <Row>\r\n        <Col md={8}>\r\n          <Card className=\"mb-3\">\r\n            <Card.Body>\r\n              <Card.Title>Shipping</Card.Title>\r\n              <Card.Text>\r\n                <strong>Name:</strong> {order.shippingAddress.fullName}\r\n                <br />\r\n                <strong>Address:</strong> {order.shippingAddress.address},{' '}\r\n                {order.shippingAddress.city}, {order.shippingAddress.postalCode}\r\n                , {order.shippingAddress.country}\r\n              </Card.Text>\r\n              {order.isDelivered ? (\r\n                <MessageBox variant=\"success\">\r\n                  Delivered at {order.deliveredAt}\r\n                </MessageBox>\r\n              ) : (\r\n                <MessageBox variant=\"danger\">Not Delivered</MessageBox>\r\n              )}\r\n            </Card.Body>\r\n          </Card>\r\n          <Card className=\"mb-3\">\r\n            <Card.Body>\r\n              <Card.Title>Payment</Card.Title>\r\n              <Card.Text>\r\n                <strong>Method:</strong> {order.paymentMethod}\r\n              </Card.Text>\r\n              {order.isPaid ? (\r\n                <MessageBox variant=\"success\">\r\n                  Paid at {order.paidAt}\r\n                </MessageBox>\r\n              ) : (\r\n                <MessageBox variant=\"danger\">Not Paid</MessageBox>\r\n              )}\r\n            </Card.Body>\r\n          </Card>\r\n          <Card className=\"mb-3\">\r\n            <Card.Body>\r\n              <Card.Title>Items</Card.Title>\r\n              <ListGroup variant=\"flush\">\r\n                {order.orderItems.map((item) => (\r\n                  <ListGroup.Item key={item._id}>\r\n                    <Row className=\"align-items-center\">\r\n                      <Col md={6}>\r\n                        <img\r\n                          src={item.image}\r\n                          alt={item.name}\r\n                          className=\"img-fluid rounded img-thumbnail\"\r\n                        ></img>{' '}\r\n                        <Link to={`/product/${item.slug}`}>{item.name}</Link>\r\n                      </Col>\r\n                      <Col md={3}>\r\n                        <span>{item.quantity}</span>\r\n                      </Col>\r\n                      <Col md={3}>${item.price}</Col>\r\n                    </Row>\r\n                  </ListGroup.Item>\r\n                ))}\r\n              </ListGroup>\r\n            </Card.Body>\r\n          </Card>\r\n        </Col>\r\n        <Col md={4}>\r\n          <Card>\r\n            <Card.Body>\r\n              <Card.Title>Order Summary</Card.Title>\r\n              <ListGroup variant=\"flush\">\r\n                <ListGroup.Item>\r\n                  <Row>\r\n                    <Col>Items</Col>\r\n                    <Col>${order.itemsPrice.toFixed(2)}</Col>\r\n                  </Row>\r\n                </ListGroup.Item>\r\n                <ListGroup.Item>\r\n                  <Row>\r\n                    <Col>Shipping</Col>\r\n                    <Col>${order.shippingPrice.toFixed(2)}</Col>\r\n                  </Row>\r\n                </ListGroup.Item>\r\n                <ListGroup.Item>\r\n                  <Row>\r\n                    <Col>Tax</Col>\r\n                    <Col>${order.taxPrice.toFixed(2)}</Col>\r\n                  </Row>\r\n                </ListGroup.Item>\r\n                <ListGroup.Item>\r\n                  <Row>\r\n                    <Col>\r\n                      <strong>Order Total</strong>\r\n                    </Col>\r\n                    <Col>\r\n                      <strong>${order.totalPrice.toFixed(2)}</strong>\r\n                    </Col>\r\n                  </Row>\r\n                </ListGroup.Item>\r\n                {!order.isPaid && (\r\n                  <ListGroup.Item>\r\n                    {isPending ? (\r\n                      <LoadingBox />\r\n                    ) : (\r\n                      <div>\r\n                        <PayPalButtons\r\n                          createOrder={createOrder}\r\n                          onApprove={onApprove}\r\n                          onError={onError}\r\n                        ></PayPalButtons>\r\n                      </div>\r\n                    )}\r\n                  </ListGroup.Item>\r\n                )}\r\n              </ListGroup>\r\n            </Card.Body>\r\n          </Card>\r\n        </Col>\r\n      </Row>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default OrderScreen;\r\n"]},"metadata":{},"sourceType":"module"}